!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.videojsKoment=e()}}(function(){return function e(t,n,o){function r(a,u){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!u&&l)return l(a,!0);if(i)return i(a,!0);var s=new Error("Cannot find module '"+a+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[a]={exports:{}};t[a][0].call(f.exports,function(e){var n=t[a][1][e];return r(n?n:e)},f,f.exports,e,t,n,o)}return n[a].exports}for(var i="function"==typeof require&&require,a=0;a<o.length;a++)r(o[a]);return r}({1:[function(e,t,n){(function(o){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),s=function(e,t,n){for(var o=!0;o;){var r=e,i=t,a=n;o=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(a)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=i,n=a,o=!0,u=s=void 0}},f="undefined"!=typeof window?window.videojs:"undefined"!=typeof o?o.videojs:null,c=i(f),d=e("../../../utils/to-title-case"),p=i(d),y=e("../../../utils/dom"),h=r(y),v=c.default.getComponent("TextTrackButton"),b=c.default.getComponent("Component"),w=c.default.getComponent("TextTrackMenuItem"),m=c.default.getComponent("ChaptersTrackMenuItem"),g=c.default.getComponent("Menu"),k=function(e){function t(e,n,o){a(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n,o),this.el_.setAttribute("aria-label","Koment Menu")}return u(t,e),l(t,[{key:"buildCSSClass",value:function(){return"vjs-koment-button "+s(Object.getPrototypeOf(t.prototype),"buildCSSClass",this).call(this)}},{key:"createItems",value:function(){var e=[],t=this.player_.textTracks();if(!t)return e;for(var n=0;n<t.length;n++){var o=t[n];o.kind===this.kind_&&e.push(new w(this.player_,{track:o}))}return e}},{key:"handleClick",value:function(e){var n=this.player_.textTracks();if(s(Object.getPrototypeOf(t.prototype),"handleClick",this).call(this,e),n)for(var o=0;o<n.length;o++){var r=n[o];r.kind===this.kind_&&(r.mode=this.buttonPressed_?"showing":"hidden")}}},{key:"createMenu",value:function(){for(var e=this,t=this.player_.textTracks()||[],n=void 0,o=this.items||[],r=t.length-1;r>=0;r--){var i=t[r];if(i.kind===this.kind_){n=i;break}}var a=this.menu;if(void 0===a){a=new g(this.player_);var u=c.default.createEl("li",{className:"vjs-menu-title",innerHTML:(0,p.default)(this.controlText_),tabIndex:-1});a.children_.unshift(u),h.insertElFirst(u,a.contentEl())}else o.forEach(function(e){return a.removeChild(e)}),o=[];if(n&&(null===n.cues||void 0===n.cues)){n.mode="hidden";var l=this.player_.remoteTextTrackEls().getTrackElementByTrack_(n);l&&l.addEventListener("load",function(t){return e.update()})}if(n&&n.cues&&n.cues.length>0)for(var s=n.cues,r=0,f=s.length;r<f;r++){var d=s[r],y=new m(this.player_,{cue:d,track:n});o.push(y)}return o.length>0&&this.show(),this.items=o,a}}]),t}(v);k.prototype.kind_="metadata",k.prototype.controlText_="Koment",b.registerComponent("KomentButton",k),n.default=k,t.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../../utils/dom":4,"../../../utils/to-title-case":5}],2:[function(e,t,n){(function(e){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(e,t,n){for(var o=!0;o;){var r=e,i=t,a=n;o=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(a)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=i,n=a,o=!0,u=s=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof e?e.videojs:null,s=o(l),f=s.default.getComponent("Button"),c=s.default.getComponent("Component"),d=function(e){function t(e,n,o){r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n,o)}return i(t,e),a(t,[{key:"buildCSSClass",value:function(){return"vjs-koment-button vjs-koment-new-button "+u(Object.getPrototypeOf(t.prototype),"buildCSSClass",this).call(this)}}]),t}(f);d.prototype.controlText_="Koment New",c.registerComponent("KomentNewButton",d),n.default=d,t.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(e,t,n){(function(o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e,t){return"rgba("+parseInt(e[1]+e[1],16)+","+parseInt(e[2]+e[2],16)+","+parseInt(e[3]+e[3],16)+","+t+")"}function l(e,t,n){try{e.style[t]=n}catch(e){return}}Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),f=function(e,t,n){for(var o=!0;o;){var r=e,i=t,a=n;o=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(a)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=i,n=a,o=!0,u=s=void 0}},c="undefined"!=typeof window?window.videojs:"undefined"!=typeof o?o.videojs:null,d=r(c),p=e("global/window"),y=r(p),h=d.default.getComponent("Component"),v="#222",b="#ccc",w={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'},m=function(e){function t(e,n,o){var r=this;i(this,t),f(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n,o),e.on("loadstart",d.default.bind(this,this.toggleDisplay)),e.on("texttrackchange",d.default.bind(this,this.updateDisplay));var a=e.textTracks();a&&!function(){var e=d.default.bind(r,r.handleTracksChange);a.addEventListener("change",e),r.on("dispose",function(){a.removeEventListener("change",e)})}(),e.ready(d.default.bind(this,function(){e.on("fullscreenchange",d.default.bind(this,this.updateDisplay));var t=this.player_.textTracks(),n=void 0;if(t){for(var o=0;o<t.length;o++){var r=t[o];r.default&&(r.kind!==this.kind_||n||(n=r))}n&&(n.mode="showing")}}))}return a(t,e),s(t,[{key:"toggleDisplay",value:function(){this.show()}},{key:"createEl",value:function(){return f(Object.getPrototypeOf(t.prototype),"createEl",this).call(this,"div",{className:"vjs-koment-track-display"},{"aria-live":"assertive","aria-atomic":"true"})}},{key:"clearDisplay",value:function(){}},{key:"handleTracksChange",value:function(){for(var e=this.player().textTracks(),t=!1,n=0,o=e.length;n<o;n++){var r=e[n];if(r.kind!==this.kind_&&"showing"===r.mode){t=!0;break}}t?this.hide():this.show(),this.updateDisplay()}},{key:"updateDisplay",value:function(){var e=this.player_.textTracks();if(this.clearDisplay(),e){for(var t=null,n=e.length,o=d.default.bind(this,this.handleTracksChange);n--;){var r=e[n];r.removeEventListener("cuechange",o),"showing"===r.mode&&r.kind===this.kind_&&(r.addEventListener("cuechange",o),t=r)}t&&this.updateForTrack(t)}}},{key:"updateForTrack",value:function(e){if("function"==typeof y.default.WebVTT&&e.activeCues){for(var t=this.player_.textTrackSettings.getValues(),n=[],o=0;o<e.activeCues.length;o++)n.push(e.activeCues[o]);y.default.WebVTT.processCues(y.default,n,this.el_);for(var r=n.length;r--;){var i=n[r];if(i){var a=i.displayState;if(t.color&&(a.firstChild.style.color=t.color),t.textOpacity&&l(a.firstChild,"color",u(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(a.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&l(a.firstChild,"backgroundColor",u(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?l(a,"backgroundColor",u(t.windowColor,t.windowOpacity)):a.style.backgroundColor=t.windowColor),t.edgeStyle&&("dropshadow"===t.edgeStyle?a.firstChild.style.textShadow="2px 2px 3px "+v+", 2px 2px 4px "+v+", 2px 2px 5px "+v:"raised"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px "+v+", 2px 2px "+v+", 3px 3px "+v:"depressed"===t.edgeStyle?a.firstChild.style.textShadow="1px 1px "+b+", 0 1px "+b+", -1px -1px "+v+", 0 -1px "+v:"uniform"===t.edgeStyle&&(a.firstChild.style.textShadow="0 0 4px "+v+", 0 0 4px "+v+", 0 0 4px "+v+", 0 0 4px "+v)),t.fontPercent&&1!==t.fontPercent){var s=y.default.parseFloat(a.style.fontSize);a.style.fontSize=s*t.fontPercent+"px",a.style.height="auto",a.style.top="auto",a.style.bottom="2px"}t.fontFamily&&"default"!==t.fontFamily&&("small-caps"===t.fontFamily?a.firstChild.style.fontVariant="small-caps":a.firstChild.style.fontFamily=w[t.fontFamily])}}}}}]),t}(h);m.prototype.kind_="metadata",h.registerComponent("KomentTrackDisplay",m),n.default=m,t.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"global/window":8}],4:[function(e,t,n){"use strict";function o(e,t){t.firstChild?t.insertBefore(e,t.firstChild):t.appendChild(e)}Object.defineProperty(n,"__esModule",{value:!0}),n.insertElFirst=o},{}],5:[function(e,t,n){"use strict";function o(e){return e.charAt(0).toUpperCase()+e.slice(1)}Object.defineProperty(n,"__esModule",{value:!0}),n.default=o,t.exports=n.default},{}],6:[function(e,t,n){(function(t){"use strict";function o(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(n,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),u=function(e,t,n){for(var o=!0;o;){var r=e,i=t,a=n;o=!1,null===r&&(r=Function.prototype);var u=Object.getOwnPropertyDescriptor(r,i);if(void 0!==u){if("value"in u)return u.value;var l=u.get;if(void 0===l)return;return l.call(a)}var s=Object.getPrototypeOf(r);if(null===s)return;e=s,t=i,n=a,o=!0,u=s=void 0}},l="undefined"!=typeof window?window.videojs:"undefined"!=typeof t?t.videojs:null,s=o(l),f=e("xhr"),c=o(f),d=e("./component/control-bar/track-controls/koment-button"),p=(o(d),e("./component/control-bar/track-controls/koment-new-button")),y=(o(p),e("./tracks/koment-track-display")),h=(o(y),s.default.getComponent("Component")),v="koment_track";n.TRACK_ID=v;var b=5;n.COMMENT_SHOW_TIME=b;var w=function(e){function t(e,n){var o=this;r(this,t),u(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,n);var i={label:"Koment",language:"fr"};this.text_track=s.default.mergeOptions(i,n,{default:!0,kind:this.kind_,id:v,cues:[],mode:"showing"});var a={json:!0,uri:this.options_.url,method:"GET",headers:{"Content-Type":"application/json"}};(0,c.default)(a,function(t,n){if(t)throw new Error(t.message);var r=e.addTextTrack(o.text_track.kind,o.text_track.label,o.text_track.language);r.default=!0;var i=n.body||[];i.forEach(function(e){r.addCue(new VTTCue(e.timecode,e.timecode+b,e.text))})})}return i(t,e),a(t,[{key:"createEl",value:function(){return u(Object.getPrototypeOf(t.prototype),"createEl",this).call(this,"div",{className:"vjs-koment-bar",dir:"ltr"},{role:"group"})}}]),t}(h);w.prototype.kind_="metadata",w.prototype.options_={url:"https://afr-api-v1-staging.herokuapp.com/api/videos/c1ee3b32-0bf8-4873-b173-09dc055b7bfe/comments",children:{komentButton:{}}},s.default.options.children=s.default.options.children.concat(["koment","komentTrackDisplay"]),h.registerComponent("Koment",w),n.default=w}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./component/control-bar/track-controls/koment-button":1,"./component/control-bar/track-controls/koment-new-button":2,"./tracks/koment-track-display":3,xhr:12}],7:[function(e,t,n){function o(e,t,n){if(!u(t))throw new TypeError("iterator must be a function");arguments.length<3&&(n=this),"[object Array]"===l.call(e)?r(e,t,n):"string"==typeof e?i(e,t,n):a(e,t,n)}function r(e,t,n){for(var o=0,r=e.length;o<r;o++)s.call(e,o)&&t.call(n,e[o],o,e)}function i(e,t,n){for(var o=0,r=e.length;o<r;o++)t.call(n,e.charAt(o),o,e)}function a(e,t,n){for(var o in e)s.call(e,o)&&t.call(n,e[o],o,e)}var u=e("is-function");t.exports=o;var l=Object.prototype.toString,s=Object.prototype.hasOwnProperty},{"is-function":9}],8:[function(e,t,n){(function(e){"undefined"!=typeof window?t.exports=window:"undefined"!=typeof e?t.exports=e:"undefined"!=typeof self?t.exports=self:t.exports={}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,n){function o(e){var t=r.call(e);return"[object Function]"===t||"function"==typeof e&&"[object RegExp]"!==t||"undefined"!=typeof window&&(e===window.setTimeout||e===window.alert||e===window.confirm||e===window.prompt)}t.exports=o;var r=Object.prototype.toString},{}],10:[function(e,t,n){var o=e("trim"),r=e("for-each"),i=function(e){return"[object Array]"===Object.prototype.toString.call(e)};t.exports=function(e){if(!e)return{};var t={};return r(o(e).split("\n"),function(e){var n=e.indexOf(":"),r=o(e.slice(0,n)).toLowerCase(),a=o(e.slice(n+1));"undefined"==typeof t[r]?t[r]=a:i(t[r])?t[r].push(a):t[r]=[t[r],a]}),t}},{"for-each":7,trim:11}],11:[function(e,t,n){function o(e){return e.replace(/^\s*|\s*$/g,"")}n=t.exports=o,n.left=function(e){return e.replace(/^\s*/,"")},n.right=function(e){return e.replace(/\s*$/,"")}},{}],12:[function(e,t,n){"use strict";function o(e,t){for(var n=0;n<e.length;n++)t(e[n])}function r(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e,t,n){var o=e;return c(t)?(n=t,"string"==typeof e&&(o={uri:e})):o=p(t,{uri:e}),o.callback=n,o}function a(e,t,n){return t=i(e,t,n),u(t)}function u(e){function t(){4===c.readyState&&i()}function n(){var e=void 0;if(e=c.response?c.response:c.responseText||l(c),k)try{e=JSON.parse(e)}catch(e){}return e}function o(e){return clearTimeout(h),e instanceof Error||(e=new Error(""+(e||"Unknown XMLHttpRequest Error"))),e.statusCode=0,s(e,f)}function i(){if(!y){var t;clearTimeout(h),t=e.useXDR&&void 0===c.status?200:1223===c.status?204:c.status;var o=f,r=null;return 0!==t?(o={body:n(),statusCode:t,method:b,headers:{},url:v,rawRequest:c},c.getAllResponseHeaders&&(o.headers=d(c.getAllResponseHeaders()))):r=new Error("Internal XMLHttpRequest Error"),s(r,o,o.body)}}if("undefined"==typeof e.callback)throw new Error("callback argument missing");var u=!1,s=function(t,n,o){u||(u=!0,e.callback(t,n,o))},f={body:void 0,headers:{},statusCode:0,method:b,url:v,rawRequest:c},c=e.xhr||null;c||(c=e.cors||e.useXDR?new a.XDomainRequest:new a.XMLHttpRequest);var p,y,h,v=c.url=e.uri||e.url,b=c.method=e.method||"GET",w=e.body||e.data||null,m=c.headers=e.headers||{},g=!!e.sync,k=!1;if("json"in e&&(k=!0,m.accept||m.Accept||(m.Accept="application/json"),"GET"!==b&&"HEAD"!==b&&(m["content-type"]||m["Content-Type"]||(m["Content-Type"]="application/json"),w=JSON.stringify(e.json))),c.onreadystatechange=t,c.onload=i,c.onerror=o,c.onprogress=function(){},c.ontimeout=o,c.open(b,v,!g,e.username,e.password),g||(c.withCredentials=!!e.withCredentials),!g&&e.timeout>0&&(h=setTimeout(function(){y=!0,c.abort("timeout");var e=new Error("XMLHttpRequest timeout");e.code="ETIMEDOUT",o(e)},e.timeout)),c.setRequestHeader)for(p in m)m.hasOwnProperty(p)&&c.setRequestHeader(p,m[p]);else if(e.headers&&!r(e.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in e&&(c.responseType=e.responseType),"beforeSend"in e&&"function"==typeof e.beforeSend&&e.beforeSend(c),c.send(w),c}function l(e){if("document"===e.responseType)return e.responseXML;var t=204===e.status&&e.responseXML&&"parsererror"===e.responseXML.documentElement.nodeName;return""!==e.responseType||t?null:e.responseXML}function s(){}var f=e("global/window"),c=e("is-function"),d=e("parse-headers"),p=e("xtend");t.exports=a,a.XMLHttpRequest=f.XMLHttpRequest||s,a.XDomainRequest="withCredentials"in new a.XMLHttpRequest?a.XMLHttpRequest:f.XDomainRequest,o(["get","put","post","patch","head","delete"],function(e){a["delete"===e?"del":e]=function(t,n,o){return n=i(t,n,o),n.method=e.toUpperCase(),u(n)}})},{"global/window":8,"is-function":9,"parse-headers":10,xtend:13}],13:[function(e,t,n){function o(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var o in n)r.call(n,o)&&(e[o]=n[o])}return e}t.exports=o;var r=Object.prototype.hasOwnProperty},{}],14:[function(e,t,n){(function(o){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(n,"__esModule",{value:!0});var i="undefined"!=typeof window?window.videojs:"undefined"!=typeof o?o.videojs:null,a=r(i),u=e("./videojs-koment"),l=r(u),s=function(e){(0,l.default)(this,e)};a.default.plugin("koment",s),n.default=s,t.exports=n.default}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./videojs-koment":6}]},{},[14])(14)});